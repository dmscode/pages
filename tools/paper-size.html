<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹è´¦å°ºå¯¸å¯¹ç…§æ‰‹å†Œ | Stationery Size Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #fafaf9;
            background-image: 
                radial-gradient(#e7e5e4 1px, transparent 1px),
                radial-gradient(#e7e5e4 1px, transparent 1px);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
        }
        
        .paper-texture {
            background-color: #fefdfb;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
        }

        .handwritten {
            font-family: 'Courier New', cursive, monospace;
            letter-spacing: -0.5px;
        }

        .binder-hole {
            width: 8px;
            height: 8px;
            background: #d6d3d1;
            border-radius: 50%;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }

        .wash-tape {
            position: relative;
            opacity: 0.9;
        }
        
        .wash-tape::before {
            content: '';
            position: absolute;
            top: -12px;
            left: 20%;
            width: 60%;
            height: 24px;
            background: repeating-linear-gradient(
                45deg,
                rgba(255,255,255,0.3),
                rgba(255,255,255,0.3) 5px,
                transparent 5px,
                transparent 10px
            );
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transform: rotate(-1deg);
        }

        .size-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .size-card:hover {
            transform: translateY(-2px) rotate(0.5deg);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.02);
        }

        .grid-lines {
            background-image: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 23px,
                #e5e5e5 24px
            );
            background-size: 100% 24px;
        }

        .dot-grid {
            background-image: radial-gradient(#d1d5db 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* ç›ç³»é…è‰²ç±» */
        .salt-pink { background-color: #faf5f5; border-color: #f5e6e8; }
        .salt-blue { background-color: #f5f7fa; border-color: #e6eef5; }
        .salt-green { background-color: #f5faf7; border-color: #e6f0ea; }
        .salt-yellow { background-color: #faf9f5; border-color: #f5f0e6; }
        .salt-purple { background-color: #f8f5fa; border-color: #f0e6f5; }

        .neo-tag {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(0,0,0,0.05);
        }

        @media print {
            .no-print { display: none; }
            .shadow-lg { box-shadow: none; }
        }
    </style>
</head>
<body class="text-stone-600 leading-relaxed antialiased">

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="sticky top-0 z-50 bg-stone-50/90 backdrop-blur-md border-b border-stone-200">
        <div class="max-w-6xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-stone-200 flex items-center justify-center handwritten font-bold text-stone-600 text-lg">D</div>
                <div>
                    <h1 class="text-xl font-medium text-stone-800 tracking-wide">æ‰‹è´¦å°ºå¯¸å¯¹ç…§æ‰‹å†Œ</h1>
                    <p class="text-xs text-stone-400">Stationery Size Reference Guide</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2">
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="æœç´¢å°ºå¯¸..." 
                           class="pl-9 pr-4 py-2 rounded-full bg-white border border-stone-200 text-sm focus:outline-none focus:ring-2 focus:ring-stone-300 w-48 transition-all">
                    <svg class="w-4 h-4 text-stone-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                </div>
                <button onclick="toggleView('grid')" class="p-2 rounded-lg hover:bg-stone-200 transition-colors" title="ç½‘æ ¼è§†å›¾">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/></svg>
                </button>
                <button onclick="toggleView('table')" class="p-2 rounded-lg hover:bg-stone-200 transition-colors" title="è¡¨æ ¼è§†å›¾">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                </button>
            </div>
        </div>
    </header>

    <!-- å¿«é€Ÿç­›é€‰æ ‡ç­¾ -->
    <div class="max-w-6xl mx-auto px-4 py-6">
        <div class="flex flex-wrap gap-2 justify-center no-print">
            <button onclick="filterByType('all')" class="filter-btn active px-4 py-2 rounded-full text-sm border border-stone-300 bg-stone-800 text-white shadow-sm transition-all hover:shadow-md" data-type="all">å…¨éƒ¨</button>
            <button onclick="filterByType('large')" class="filter-btn px-4 py-2 rounded-full text-sm border border-stone-200 bg-white text-stone-600 hover:bg-stone-50 transition-all" data-type="large">å¤§å‹(A5+)</button>
            <button onclick="filterByType('medium')" class="filter-btn px-4 py-2 rounded-full text-sm border border-stone-200 bg-white text-stone-600 hover:bg-stone-50 transition-all" data-type="medium">ä¸­å‹(A6å®¶æ—)</button>
            <button onclick="filterByType('small')" class="filter-btn px-4 py-2 rounded-full text-sm border border-stone-200 bg-white text-stone-600 hover:bg-stone-50 transition-all" data-type="small">å°å‹(A7/A8)</button>
            <button onclick="filterByType('fold')" class="filter-btn px-4 py-2 rounded-full text-sm border border-stone-200 bg-white text-stone-600 hover:bg-stone-50 transition-all" data-type="fold">æŠ˜é¡µ</button>
            <button onclick="filterByType('compatible')" class="filter-btn px-4 py-2 rounded-full text-sm border border-rose-200 bg-rose-50 text-rose-600 hover:bg-rose-100 transition-all" data-type="compatible">âš¡ é«˜å…¼å®¹</button>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒº -->
    <main class="max-w-6xl mx-auto px-4 pb-20">
        
        <!-- è”åŠ¨å…³ç³»å¯è§†åŒ– -->
        <section class="mb-12 paper-texture rounded-2xl p-6 shadow-sm border border-stone-100 wash-tape">
            <h2 class="text-lg font-medium text-stone-800 mb-4 flex items-center gap-2 handwritten">
                <span class="w-2 h-2 rounded-full bg-stone-400"></span>
                å¥—å¨ƒæ”¶çº³å…³ç³»å›¾
            </h2>
            <div class="overflow-x-auto">
                <div class="flex items-end gap-1 min-w-max pb-4" id="nestingChart">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            <p class="text-xs text-stone-400 mt-2 italic">ç‚¹å‡»å°ºå¯¸æŸ¥çœ‹å¯æ”¶çº³çš„å°å°ºå¯¸å†…é¡µ</p>
        </section>

        <!-- å°ºå¯¸å¡ç‰‡ç½‘æ ¼ -->
        <div id="sizeGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            <!-- å¡ç‰‡ç”±JSç”Ÿæˆ -->
        </div>

        <!-- å¯¹ç…§å·¥å…·åŒº -->
        <section class="grid md:grid-cols-2 gap-6 mb-12">
            <!-- æŠ˜é¡µè®¡ç®—å™¨ -->
            <div class="paper-texture rounded-2xl p-6 shadow-sm border border-stone-100">
                <h3 class="text-lg font-medium text-stone-800 mb-4 handwritten flex items-center gap-2">
                    <svg class="w-5 h-5 text-stone-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                    æŠ˜é¡µå°ºå¯¸è®¡ç®—å™¨
                </h3>
                <div class="space-y-3">
                    <select id="calcSize" class="w-full p-3 rounded-lg border border-stone-200 bg-white text-sm focus:outline-none focus:border-stone-400">
                        <option value="">é€‰æ‹©åŸºç¡€å°ºå¯¸...</option>
                    </select>
                    <div class="flex gap-2">
                        <button onclick="calcFold('bifold')" class="flex-1 py-2 rounded-lg bg-stone-100 hover:bg-stone-200 text-stone-700 text-sm transition-colors">äºŒæŠ˜é¡µ</button>
                        <button onclick="calcFold('trifold')" class="flex-1 py-2 rounded-lg bg-stone-100 hover:bg-stone-200 text-stone-700 text-sm transition-colors">ä¸‰æŠ˜é¡µ</button>
                    </div>
                    <div id="calcResult" class="hidden mt-4 p-4 bg-stone-50 rounded-lg text-sm border border-stone-200">
                        <!-- ç»“æœ -->
                    </div>
                </div>
            </div>

            <!-- å­”ä½å¯¹ç…§ -->
            <div class="paper-texture rounded-2xl p-6 shadow-sm border border-stone-100">
                <h3 class="text-lg font-medium text-stone-800 mb-4 handwritten flex items-center gap-2">
                    <svg class="w-5 h-5 text-stone-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/></svg>
                    å­”ä½ä½“ç³»é€ŸæŸ¥
                </h3>
                <div class="space-y-4">
                    <div class="flex items-start gap-3 p-3 rounded-lg bg-white border border-stone-200">
                        <div class="flex flex-col gap-1 mt-1">
                            <div class="w-2 h-2 rounded-full bg-stone-300"></div>
                            <div class="w-2 h-2 rounded-full bg-stone-300"></div>
                            <div class="w-2 h-2 rounded-full bg-stone-300"></div>
                        </div>
                        <div class="flex-1">
                            <div class="text-sm font-medium text-stone-800">æ¬§ç¾6å­”æ ‡å‡†</div>
                            <div class="text-xs text-stone-500 mt-1">19mmé—´è· | A5/Personal/A6/A7é€šç”¨</div>
                            <div class="text-xs text-rose-500 mt-1">âš ï¸ ä¸æ—¥ç³»20å­”ä¸å…¼å®¹</div>
                        </div>
                    </div>
                    <div class="flex items-start gap-3 p-3 rounded-lg bg-white border border-stone-200">
                        <div class="flex flex-col gap-[2px] mt-1">
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                        </div>
                        <div class="flex-1">
                            <div class="text-sm font-medium text-stone-800">æ—¥ç³»20/26å­”</div>
                            <div class="text-xs text-stone-500 mt-1">9.5mmå‡åŒ€å­”è· | B5(26å­”)/A5(20å­”)</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ–°æ‰‹æ¨è -->
        <section class="paper-texture rounded-2xl p-8 shadow-sm border border-stone-100 salt-blue">
            <h2 class="text-xl font-medium text-stone-800 mb-6 handwritten text-center">æ–°æ‰‹å…¥å‘æ¨è Â· Less is More</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center p-6 rounded-xl bg-white/60 border border-stone-200">
                    <div class="text-3xl mb-3">ğŸ“</div>
                    <h4 class="font-medium text-stone-800 mb-2">å·¥ä½œå­¦ä¹ é¦–é€‰</h4>
                    <p class="text-sm text-stone-600 mb-3">A5 æˆ– A5 Slim</p>
                    <p class="text-xs text-stone-400">ä¹¦å†™ç©ºé—´å¤§ï¼ŒA5slimå¯æ”¶çº³A4ä¸‰æŠ˜é¡µï¼Œé€‚åˆç¬”è®°è®°å½•</p>
                </div>
                <div class="text-center p-6 rounded-xl bg-white/60 border border-rose-200 ring-2 ring-rose-100">
                    <div class="text-3xl mb-3">â­</div>
                    <h4 class="font-medium text-stone-800 mb-2">äººæ°”ä¹‹é€‰</h4>
                    <p class="text-sm text-stone-600 mb-3">A6 Personal (95Ã—170)</p>
                    <p class="text-xs text-stone-400">é…ä»¶æœ€ä¸°å¯Œï¼ŒAll-in-oneæ—¥ç¨‹ç®¡ç†ï¼Œå¹³è¡¡ä¾¿æºä¸ä¹¦å†™</p>
                </div>
                <div class="text-center p-6 rounded-xl bg-white/60 border border-stone-200">
                    <div class="text-3xl mb-3">ğŸ‘œ</div>
                    <h4 class="font-medium text-stone-800 mb-2">éšèº«ä¾¿æº</h4>
                    <p class="text-sm text-stone-600 mb-3">A7 Pocket æˆ– M5</p>
                    <p class="text-xs text-stone-400">A7é€‚åˆæ—¥å¸¸è®°å½•ï¼ŒM5æè‡´å°å·§ï¼ŒA8/M5å®½67mmè”åŠ¨æ€§æœ€å¥½</p>
                </div>
            </div>
        </section>

    </main>

    <!-- é¡µè„š -->
    <footer class="border-t border-stone-200 bg-stone-50 py-8 text-center text-sm text-stone-400">
        <p>æ•°æ®ç»¼åˆæ•´ç†è‡ª @é’è—¤å°ç¬º ä¸ @ç”»ä¸ªå°ç”»sunnyplan</p>
        <p class="mt-2 text-xs">ä¸åŒå“ç‰Œå­˜åœ¨1-3mmè¯¯å·®å±æ­£å¸¸èŒƒå›´ï¼Œè´­ä¹°å‰è¯·ä»¥å®ç‰©å†…å¾„ä¸ºå‡†</p>
    </footer>

    <script>
        // æ‰‹è´¦æ•°æ®
        const sizeData = [
            // å¤§å‹
            { id: 'a5', name: 'A5', size: '144Ã—210', type: 'large', holes: 6, pitch: '19-19-70-19-19', system: 'æ¬§ç¾', color: 'salt-yellow', note: 'æ ‡å‡†å°ºå¯¸ï¼Œä¹¦å†™ç©ºé—´å……è£•ï¼Œé€‚åˆå·¥ä½œå­¦ä¹ ', fold2: '273Ã—210', fold3: '406Ã—210', compatible: ['a5s', 'a7', 'a8'] },
            { id: 'a5s', name: 'A5 Slim', size: '110Ã—210', type: 'large', holes: 6, pitch: '19-19-70-19-19', system: 'æ¬§ç¾', color: 'salt-green', note: 'ä¸A5åŒé«˜ï¼Œå®½åº¦çª„34mmï¼Œæ›´ä¾¿æºï¼Œå¯æ”¶çº³A4ä¸‰æŠ˜é¡µ', fold2: '205Ã—210', fold3: '304Ã—210', compatible: ['a7', 'a8'] },
            { id: 'puo', name: 'PUO', size: '110Ã—210', type: 'large', holes: 20, pitch: '9.5mmå‡åŒ€', system: 'æ—¥ç³»', color: 'salt-blue', note: '20å­”A5 Slimï¼Œå¯ä¸TNæ ‡å‡†æœ¬æ­é…', compatible: [] },
            
            // ä¸­å‹ - Personalå®¶æ—(170mmé«˜)
            { id: 'a6s', name: 'A6 Slim', size: '80Ã—170', type: 'medium', holes: 6, pitch: '19-19-50-19-19', system: 'æ¬§ç¾', color: 'salt-purple', note: '80mmå®½åº¦å®¶æ—ï¼Œå¯æ”¾å…¥Personalæœ¬çš®', compatible: ['a8'] },
            { id: 'personal', name: 'A6 Personal', size: '95Ã—170', type: 'medium', holes: 6, pitch: '19-19-50-19-19', system: 'æ¬§ç¾', color: 'salt-pink', note: 'âš¡æœ€å¸¸ç”¨å°ºå¯¸ï¼Œé…ä»¶å†…é¡µæœ€ä¸°å¯Œï¼Œæ–°æ‰‹é¦–é€‰', fold2: '177Ã—170', fold3: '259Ã—170', compatible: ['a6s', 'a8'] },
            { id: 'fc', name: 'A6 FC', size: '108Ã—170', type: 'medium', holes: 6, pitch: '19-19-50-19-19', system: 'æ¬§ç¾', color: 'salt-blue', note: 'åŒPersonalå­”ç³»ï¼Œå®½åº¦é€’å¢', compatible: ['personal', 'a6s', 'a8'] },
            { id: 'pw', name: 'A6 PW', size: '120Ã—170', type: 'medium', holes: 6, pitch: '19-19-50-19-19', system: 'æ¬§ç¾', color: 'salt-green', note: 'åŒPersonalå­”ç³»', compatible: ['personal', 'a6s', 'a8'] },
            { id: 'square', name: 'A6 æ–¹æ–¹å­', size: '150Ã—170', type: 'medium', holes: 6, pitch: '19-19-50-19-19', system: 'æ¬§ç¾', color: 'salt-yellow', note: 'åŒå­”ç³»æœ€å®½ï¼Œå›½å†…å°ä¼—ï¼ŒåŸåHBÃ—WA5', compatible: ['personal', 'fc', 'pw', 'a6s', 'a8'] },
            { id: 'a6weird', name: 'A6 å¥‡è‘©', size: '105Ã—148', type: 'medium', holes: 6, pitch: '19-19-38-19-19', system: 'ç‹¬ç«‹', color: 'salt-purple', note: 'ç‹¬ç‰¹å­”ç³»ï¼Œå¯å…¼å®¹A7å’ŒM5å†…é¡µï¼ŒSmartä¸‰åˆä¸€', fold2: '197Ã—148', fold3: '289Ã—148', compatible: ['a7', 'a8'] },
            
            // å°å‹
            { id: 'a7', name: 'A7', size: '80Ã—120', type: 'small', holes: 6, pitch: '19-19-19-19-19', system: 'æ¬§ç¾', color: 'salt-pink', note: 'Pocketå°ºå¯¸ï¼Œå›½å¤–ä¹Ÿç§°Pocketï¼Œä¾¿æºé¦–é€‰', fold2: '148Ã—120', fold3: '216Ã—120', compatible: ['a8'] },
            { id: 'a7large', name: 'A7 å¤§çº¸', size: '80Ã—127', type: 'small', holes: 6, pitch: '19-19-19-19-19', system: 'æ¬§ç¾', color: 'salt-blue', note: 'æ¯”æ ‡å‡†A7é«˜7mmï¼Œç¼“è§£ç©ºé—´å±€ä¿ƒ', compatible: ['a8'] },
            { id: 'a8', name: 'A8/M5(67)', size: '67Ã—105', type: 'small', holes: 6, pitch: '19-19-19-19', system: 'M5', color: 'salt-green', note: 'âš¡M5ä¸­è”åŠ¨æ€§æœ€å¥½çš„å°ºå¯¸ï¼Œå¯æ”¾å…¥A7/å¥‡è‘©', fold2: '123Ã—105', fold3: '179Ã—105', compatible: [] },
            { id: 'm5-62', name: 'M5 å®½62', size: '62Ã—105', type: 'small', holes: 6, pitch: '19mm', system: 'M5', color: 'salt-yellow', note: 'æ›´å°å·§çš„M5å˜ä½“', compatible: [] },
            { id: 'm5-74', name: 'M5 å®½74', size: '74Ã—105', type: 'small', holes: 6, pitch: '19mm', system: 'M5', color: 'salt-purple', note: 'æ›´å®½çš„M5å˜ä½“ï¼Œéœ€ç¡®è®¤æœ¬çš®é€‚é…', compatible: [] },
            { id: 'm2.5', name: 'M2.5', size: '42Ã—105', type: 'small', holes: 0, pitch: '-', system: 'æå°', color: 'salt-blue', note: 'æå°å°ºå¯¸ï¼Œé…ä»¶æå°‘ï¼Œè°¨æ…å…¥å‘', compatible: [] },
            { id: 'a9', name: 'A9', size: '60Ã—78', type: 'small', holes: 3, pitch: '28-28', system: 'ç‹¬ç«‹', color: 'salt-yellow', note: 'âŒæ— æ³•ä¸å…¶ä»–å°ºå¯¸è”åŠ¨ï¼Œé€‚åˆå•ç‹¬åšè¿·ä½ æ‰“å¡æœ¬', compatible: [] },
        ];

        let currentView = 'grid';
        let currentFilter = 'all';

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderGrid();
            renderNestingChart();
            populateCalcOptions();
            
            // æœç´¢ç›‘å¬
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                filterBySearch(term);
            });
        });

        function renderGrid() {
            const grid = document.getElementById('sizeGrid');
            grid.innerHTML = '';
            
            const filtered = currentFilter === 'all' ? sizeData : 
                           currentFilter === 'compatible' ? sizeData.filter(d => d.compatible.length > 0) :
                           sizeData.filter(d => d.type === currentFilter);
            
            filtered.forEach(item => {
                const card = createCard(item);
                grid.appendChild(card);
            });
        }

        function createCard(item) {
            const div = document.createElement('div');
            div.className = `size-card ${item.color} rounded-2xl p-6 border-2 relative overflow-hidden paper-texture`;
            div.dataset.id = item.id;
            
            // å­”ä½å¯è§†åŒ–
            let holesHtml = '';
            if (item.holes > 0) {
                holesHtml = '<div class="absolute left-3 top-8 bottom-8 flex flex-col justify-between py-2">';
                for(let i=0; i<Math.min(item.holes, 6); i++) {
                    holesHtml += '<div class="binder-hole"></div>';
                }
                holesHtml += '</div>';
            }
            
            // å…¼å®¹æ ‡ç­¾
            const compatTags = item.compatible.map(c => {
                const target = sizeData.find(d => d.id === c);
                return `<span class="inline-block px-2 py-1 bg-white/80 rounded text-xs text-stone-600 border border-stone-200 mr-1 mb-1">${target?.name || c}</span>`;
            }).join('');
            
            div.innerHTML = `
                ${holesHtml}
                <div class="pl-6">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-bold text-stone-800 handwritten">${item.name}</h3>
                        <span class="text-xs px-2 py-1 rounded-full bg-white/60 border border-stone-200 text-stone-500">${item.system}</span>
                    </div>
                    
                    <div class="font-mono text-2xl font-medium text-stone-700 mb-2 tracking-tight">${item.size}<span class="text-sm text-stone-400 ml-1">mm</span></div>
                    
                    <div class="flex items-center gap-2 mb-3 text-xs text-stone-500">
                        <span class="flex items-center gap-1">
                            <div class="w-1.5 h-1.5 rounded-full bg-stone-400"></div>
                            ${item.holes}å­”
                        </span>
                        <span>|</span>
                        <span>${item.pitch}</span>
                    </div>
                    
                    <p class="text-sm text-stone-600 mb-4 leading-relaxed">${item.note}</p>
                    
                    ${item.compatible.length > 0 ? `
                        <div class="border-t border-stone-300/50 pt-3 mt-3">
                            <div class="text-xs text-stone-400 mb-2">å¯æ”¶çº³å†…é¡µï¼š</div>
                            <div class="flex flex-wrap">${compatTags}</div>
                        </div>
                    ` : ''}
                    
                    ${item.fold2 ? `
                        <div class="mt-3 pt-3 border-t border-stone-300/50 text-xs text-stone-500 grid grid-cols-2 gap-2">
                            <div>äºŒæŠ˜: ${item.fold2}</div>
                            <div>ä¸‰æŠ˜: ${item.fold3}</div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            div.onclick = () => showDetail(item);
            return div;
        }

        function renderNestingChart() {
            const chart = document.getElementById('nestingChart');
            const nestingOrder = ['a5', 'square', 'pw', 'fc', 'personal', 'a6weird', 'a7', 'a8', 'a9'];
            
            nestingOrder.forEach((id, index) => {
                const item = sizeData.find(d => d.id === id);
                if (!item) return;
                
                const width = parseInt(item.size.split('Ã—')[0]);
                const height = parseInt(item.size.split('Ã—')[1]);
                const scale = 0.8; // ç¼©æ”¾æ¯”ä¾‹
                
                const div = document.createElement('div');
                div.className = 'relative cursor-pointer transition-all hover:-translate-y-1';
                div.style.width = `${width * scale}px`;
                div.style.height = `${height * scale}px`;
                div.style.minWidth = `${width * scale}px`;
                div.style.zIndex = 10 - index;
                div.className += ` ${item.color} border-2 border-stone-300 rounded shadow-sm flex flex-col items-center justify-center p-1 text-center`;
                
                div.innerHTML = `
                    <div class="text-[10px] font-bold text-stone-700 leading-tight">${item.name}</div>
                    <div class="text-[8px] text-stone-500 mt-1">${item.size}</div>
                `;
                
                div.onclick = () => highlightCompatible(item.id);
                chart.appendChild(div);
            });
        }

        function highlightCompatible(id) {
            const item = sizeData.find(d => d.id === id);
            if (!item || !item.compatible.length) return;
            
            // é«˜äº®å¯æ”¶çº³çš„å°ºå¯¸
            document.querySelectorAll('.size-card').forEach(card => {
                card.style.opacity = '0.4';
                if (item.compatible.includes(card.dataset.id) || card.dataset.id === id) {
                    card.style.opacity = '1';
                    card.style.transform = 'scale(1.02)';
                    setTimeout(() => card.style.transform = '', 200);
                }
            });
            
            setTimeout(() => {
                document.querySelectorAll('.size-card').forEach(card => {
                    card.style.opacity = '1';
                });
            }, 2000);
        }

        function filterByType(type) {
            currentFilter = type;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.dataset.type === type) {
                    btn.classList.add('bg-stone-800', 'text-white');
                    btn.classList.remove('bg-white', 'text-stone-600');
                } else {
                    btn.classList.remove('bg-stone-800', 'text-white');
                    btn.classList.add('bg-white', 'text-stone-600');
                }
            });
            
            renderGrid();
        }

        function filterBySearch(term) {
            const cards = document.querySelectorAll('.size-card');
            cards.forEach(card => {
                const item = sizeData.find(d => d.id === card.dataset.id);
                const match = item.name.toLowerCase().includes(term) || 
                             item.size.includes(term) || 
                             item.note.toLowerCase().includes(term);
                card.style.display = match ? 'block' : 'none';
            });
        }

        function toggleView(view) {
            currentView = view;
            const grid = document.getElementById('sizeGrid');
            if (view === 'table') {
                grid.className = 'space-y-2 mb-12';
                // é‡æ–°æ¸²æŸ“ä¸ºè¡¨æ ¼è¡Œ
                grid.innerHTML = '';
                sizeData.forEach(item => {
                    const row = document.createElement('div');
                    row.className = 'paper-texture p-4 rounded-lg border border-stone-200 flex flex-wrap items-center gap-4 text-sm';
                    row.innerHTML = `
                        <div class="w-24 font-bold text-stone-800">${item.name}</div>
                        <div class="w-24 font-mono text-stone-600">${item.size}</div>
                        <div class="w-16 text-stone-500">${item.holes}å­”</div>
                        <div class="w-32 text-stone-400 text-xs">${item.pitch}</div>
                        <div class="flex-1 text-stone-600">${item.note}</div>
                    `;
                    grid.appendChild(row);
                });
            } else {
                grid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12';
                renderGrid();
            }
        }

        function populateCalcOptions() {
            const select = document.getElementById('calcSize');
            sizeData.filter(d => d.fold2).forEach(item => {
                const opt = document.createElement('option');
                opt.value = JSON.stringify({w: item.size.split('Ã—')[0], h: item.size.split('Ã—')[1]});
                opt.textContent = `${item.name} (${item.size})`;
                select.appendChild(opt);
            });
        }

        function calcFold(type) {
            const select = document.getElementById('calcSize');
            if (!select.value) return;
            
            const dims = JSON.parse(select.value);
            const w = parseInt(dims.w);
            const h = parseInt(dims.h);
            
            let result = '';
            if (type === 'bifold') {
                const foldW = Math.round(w * 2);
                result = `äºŒæŠ˜é¡µå°ºå¯¸ï¼š<span class="font-mono font-bold text-stone-800 text-lg">${foldW}Ã—${h}mm</span><br><span class="text-xs text-stone-400">æŠ˜å åï¼š${w}Ã—${h}mm</span>`;
            } else {
                const foldW = Math.round(w * 3);
                result = `ä¸‰æŠ˜é¡µå°ºå¯¸ï¼š<span class="font-mono font-bold text-stone-800 text-lg">${foldW}Ã—${h}mm</span><br><span class="text-xs text-stone-400">æŠ˜å åï¼š${w}Ã—${h}mm (æ¯æŠ˜çº¦${Math.round(w/3*10)/10}cm)</span>`;
            }
            
            const resDiv = document.getElementById('calcResult');
            resDiv.innerHTML = result;
            resDiv.classList.remove('hidden');
        }

        function showDetail(item) {
            // ç®€å•çš„è¯¦æƒ…å±•ç¤ºï¼Œå¯ä»¥æ‰©å±•ä¸ºæ¨¡æ€æ¡†
            console.log('Detail:', item);
        }
    </script>
</body>
</html>